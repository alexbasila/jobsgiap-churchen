<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>JobsGIAP · Churchen V3 (Endversion-MVP)</title>
<style>
  :root{--w:920px}
  *{box-sizing:border-box}
  body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#fafafa;color:#0f172a}
  header{background:#0f172a;color:#fff}
  .top{max-width:var(--w);margin:0 auto;padding:14px 16px;display:flex;align-items:center;justify-content:space-between}
  .brand{font-weight:800;letter-spacing:.2px}
  main{max-width:var(--w);margin:0 auto;padding:18px}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px;margin:12px 0;box-shadow:0 6px 20px rgba(0,0,0,.05)}
  h1{margin:8px 0 0;font-size:26px}
  h2{margin:0 0 10px}
  .lead{color:#475569;margin:6px 0 2px}
  textarea{width:100%;min-height:140px;padding:12px;border:1px solid #cbd5e1;border-radius:12px;font:inherit}
  input[readonly]{width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:12px;background:#f8fafc}
  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  button{padding:10px 14px;border-radius:12px;border:1px solid #0f172a;background:#0f172a;color:#fff;font-weight:700;cursor:pointer}
  button.secondary{background:#fff;color:#0f172a}
  .muted{color:#64748b;font-size:13px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .tag{display:inline-block;padding:2px 8px;border:1px solid #0f172a;border-radius:999px;font-size:12px;margin-right:6px}
  .pill{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid #0f172a;background:#fff;color:#0f172a;font-size:12px;cursor:pointer}
  .list{list-style:none;margin:0;padding:0}
  .list li{padding:8px;border-bottom:1px solid #eee}
  .score{font-weight:700}
  .right{display:flex;gap:8px;align-items:center}
  /* modal */
  #modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;place-items:center;z-index:1000;padding:16px}
  #modal .box{background:#fff;border-radius:14px;max-width:520px;width:100%;padding:18px;box-shadow:0 16px 40px rgba(0,0,0,.25)}
</style>
</head>
<body>
<header>
  <div class="top">
    <div class="brand">JobsGIAP — One Idea, One Address, Global Reach</div>
    <div class="right">
      <button id="btn-open-drafts" class="secondary" title="Open Drafts & Pricing">Drafts</button>
    </div>
  </div>
</header>

<main>
  <section class="card">
    <h1>Every Idea. One Click. Global Reach.</h1>
    <p class="lead">Write your idea. See similar ideas instantly. Get an address at birth.</p>
  </section>

  <!-- Capture -->
  <section class="card">
    <h2>1) Capture Idea → Create Address</h2>
    <textarea id="idea" placeholder="Write your idea here…"></textarea>
    <div class="row">
      <button id="btn-churchen">Churchen</button>
      <button id="btn-clear" class="secondary">Clear</button>
    </div>
    <p class="muted">Local-only. Nothing leaves your device.</p>
  </section>

  <!-- Output -->
  <section class="card" id="out" style="display:none">
    <h2>Address</h2>
    <div class="grid">
      <div>
        <label>IdeaID</label>
        <input id="ideaId" type="text" readonly>
      </div>
      <div>
        <label>Content Hash (SHA-256)</label>
        <input id="hash" type="text" readonly>
      </div>
    </div>
    <div class="row" style="justify-content:flex-end">
      <button id="btn-copy" class="secondary">Copy IdeaID</button>
    </div>
  </section>

  <!-- Similar Ideas -->
  <section class="card">
    <h2>2) Similar Ideas (Live)</h2>
    <ul class="list" id="similar"></ul>
    <p class="muted">Demo corpus (Shakespeare, Nietzsche, Drake, Ada Lovelace, etc.). For feel & flow only.</p>
  </section>
</main>

<!-- Drafts / Pricing Modal -->
<div id="modal">
  <div class="box">
    <h2 style="margin:0 0 8px">Drafts — Post Your Idea</h2>
    <p class="lead">Two options. Pay only when you’re ready to publish to the global registry.</p>
    <ul class="list">
      <li>
        <div class="row" style="justify-content:space-between;align-items:center">
          <div><b>Single Post</b> — one idea submission<br><span class="muted">No wallet required</span></div>
          <button class="pill" id="pay-once">€0.60 (placeholder)</button>
        </div>
      </li>
      <li>
        <div class="row" style="justify-content:space-between;align-items:center">
          <div><b>Wallet</b> — load $1.00, gets you 3 posts<br><span class="muted">Can be used anytime</span></div>
          <button class="pill" id="load-wallet">$1 → 3 posts (placeholder)</button>
        </div>
      </li>
    </ul>
    <div class="row" style="justify-content:flex-end;margin-top:10px">
      <button id="close-modal" class="secondary">Close</button>
    </div>
  </div>
</div>

<script>
/* ===== Utilities ===== */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const today = () => new Date().toISOString().slice(0,10).replace(/-/g,'');
async function sha256Hex(str){
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
  return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,'0')).join('');
}
const makeId = h => `giap:${today()}-${h.slice(0,10)}`;

/* ===== Demo Corpus (tiny, for vibe) ===== */
const CORPUS = [
  { who:'William Shakespeare', title:'“There is nothing either good or bad, but thinking makes it so.”', tags:['philosophy','human-nature','thought'] },
  { who:'Friedrich Nietzsche', title:'Amor fati — love your fate', tags:['philosophy','resilience','ethics'] },
  { who:'Sir Francis Drake', title:'Circumnavigation vision & logistics', tags:['exploration','navigation','risk'] },
  { who:'Ada Lovelace', title:'Notes on analytical engine programming', tags:['computing','algorithms','logic'] },
  { who:'Rachel Carson', title:'Silent Spring — ecology alarm', tags:['environment','policy','health'] },
  { who:'Buckminster Fuller', title:'Dymaxion / do more with less', tags:['design','systems','efficiency'] },
  { who:'Elinor Ostrom', title:'Governing the Commons', tags:['governance','commons','incentives'] },
  { who:'Claude Shannon', title:'Information as uncertainty reduction', tags:['information','math','communication'] },
];

/* Very light similarity: token overlap + tag cues */
function tokenize(s){ return String(s||'').toLowerCase().replace(/[^a-z0-9\s]/g,' ').split(/\s+/).filter(Boolean); }
function jaccard(a,b){
  const A=new Set(a), B=new Set(b);
  const inter=[...A].filter(x=>B.has(x)).length;
  const uni=new Set([...A,...B]).size||1;
  return inter/uni;
}
function scoreIdea(text, item){
  const toks = tokenize(text);
  const base = jaccard(toks, tokenize(item.title));
  const tagBoost = (item.tags||[]).some(t => toks.includes(t)) ? 0.15 : 0;
  return Math.min(1, base + tagBoost);
}
function renderSimilar(text){
  const list = CORPUS
    .map(it => ({...it, s: scoreIdea(text, it)}))
    .sort((a,b)=>b.s-a.s)
    .slice(0,5);
  const ul = $('#similar'); ul.innerHTML='';
  for(const it of list){
    const li = document.createElement('li');
    li.innerHTML = `<div style="display:flex;justify-content:space-between;gap:10px;align-items:center">
      <div>
        <div><b>${it.who}</b> — ${it.title}</div>
        <div style="margin-top:4px">${(it.tags||[]).map(t=>`<span class="tag">${t}</span>`).join(' ')}</div>
      </div>
      <div class="score">${Math.round(it.s*100)}%</div>
    </div>`;
    ul.appendChild(li);
  }
}

/* ===== UI Wireup ===== */
const ta = $('#idea');

ta.addEventListener('input', ()=> renderSimilar(ta.value));

$('#btn-churchen').addEventListener('click', async ()=>{
  const text = (ta.value||'').trim();
  if(!text){ alert('Please write your idea first.'); return; }
  const hash = await sha256Hex(text);
  $('#hash').value = hash;
  $('#ideaId').value = makeId(hash);
  $('#out').style.display = '';
  renderSimilar(text);
  // Drafts-Button optisch „arm“ -> „aktiv“
  $('#btn-open-drafts').style.borderColor = '#16a34a';
  $('#btn-open-drafts').style.color = '#16a34a';
});

$('#btn-clear').addEventListener('click', ()=>{
  ta.value=''; $('#out').style.display='none'; $('#ideaId').value=''; $('#hash').value='';
  renderSimilar('');
  $('#btn-open-drafts').style.borderColor = '#0f172a';
  $('#btn-open-drafts').style.color = '#0f172a';
});

$('#btn-copy').addEventListener('click', async ()=>{
  try{ await navigator.clipboard.writeText($('#ideaId').value||''); }catch{}
});

/* Drafts modal (payment placeholders) */
const modal = $('#modal');
$('#btn-open-drafts').addEventListener('click', ()=> modal.style.display='grid');
$('#close-modal').addEventListener('click', ()=> modal.style.display='none');
$('#pay-once').addEventListener('click', ()=>{
  alert('Payment placeholder. Next step: connect Stripe Checkout (one-time €0.60) and call /drafts/create.');
});
$('#load-wallet').addEventListener('click', ()=>{
  alert('Wallet placeholder. Next step: Stripe Payment Link for $1 balance → credit 3 posts.');
});

/* Initial similar */
renderSimilar('');
</script>
</body>
</html>
