<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GIAP · Churchen</title>
  <meta name="theme-color" content="#0f172a" />
  <style>
    :root{--w:940px}
    *{box-sizing:border-box}
    body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#fafafa;color:#0f172a}
    header{background:#0f172a;color:#fff}
    .bar{max-width:var(--w);margin:0 auto;padding:12px 16px;display:flex;align-items:center;justify-content:space-between}
    main{max-width:var(--w);margin:0 auto;padding:16px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px;margin:12px 0;box-shadow:0 6px 20px rgba(0,0,0,.05)}
    h1{margin:6px 0 0;font-size:26px}
    h2{margin:0 0 8px}
    .lead{color:#475569;margin:6px 0 2px}
    textarea{width:100%;min-height:140px;padding:12px;border:1px solid #cbd5e1;border-radius:12px;font:inherit}
    input[type=text]{width:100%;padding:10px;border:1px solid #cbd5e1;border-radius:12px;font:inherit}
    input[readonly]{background:#f8fafc}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    button{padding:10px 14px;border-radius:12px;border:1px solid #0f172a;background:#0f172a;color:#fff;font-weight:700;cursor:pointer}
    button.secondary{background:#fff;color:#0f172a}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .list{list-style:none;margin:0;padding:0}
    .list li{padding:8px;border-bottom:1px solid #eee}
    small.muted{color:#64748b}
    code.k{background:#eef2ff;border:1px solid #c7d2fe;border-radius:8px;padding:3px 6px}
    #log{white-space:pre-wrap;background:#0f172a;color:#e2e8f0;padding:12px;border-radius:10px;max-height:240px;overflow:auto;margin:0}
  </style>
</head>
<body>

  <header>
    <div class="bar">
      <div style="font-weight:800;letter-spacing:.2px">GIAP — Churchen</div>
      <div class="row" style="margin-top:0">
        <button class="secondary" title="Install to home screen">Install</button>
        <button class="secondary" title="Ping API /health">Check API</button>
      </div>
    </div>
  </header>

  <main>
    <!-- Intro -->
    <section class="card">
      <h1>Every Idea. One Click. Global Reach.</h1>
      <p class="lead">Schreibe deine Idee, erhalte sofort eine Adresse & sieh ähnliche Ideen.</p>
    </section>

    <!-- 1) Capture -->
    <section class="card">
      <h2>1) Capture → Churchen</h2>
      <textarea id="idea" placeholder="Write your idea here…"></textarea>
      <input id="tags" type="text" placeholder="(optional) tags, comma-separated e.g. water, solar, protocol" />
      <label style="display:flex;align-items:center;gap:6px;margin-top:8px">
        <input id="force-gpt" type="checkbox" />
        <span>Always use GPT heritage (debug)</span>
      </label>
      <div class="row">
        <button id="btn-churchen">Churchen (ID + Matches)</button>
        <button id="btn-clear" class="secondary">Clear</button>
      </div>
      <small class="muted">Hinweis: Der Text wird an deine GIAP-API geschickt (siehe <code class="k">API_BASE</code> in <code class="k">app.js</code>).</small>
    </section>

    <!-- 2) Ergebnis -->
    <section class="card" id="out" style="display:none">
      <h2>2) Ergebnis</h2>
      <div class="grid">
        <div>
          <label>IdeaID</label>
          <input id="ideaId" type="text" readonly />
        </div>
        <div>
          <label>Content Hash (SHA-256)</label>
          <input id="hash" type="text" readonly />
        </div>
      </div>

      <div style="margin-top:10px">
        <h3 style="margin:0 0 6px">Matches
       </h3>
        <ul id="matches" class="list"></ul>
        <div style="margin-top:8px">
          <small id="ai-status" class="muted">AI status: n/a</small>
        </div>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="btn-publish">Publish (ins Registry)</button>
        <button id="btn-copy-ideal" class="secondary">Copy IdeaID</button>
        <button id="btn-open-json" class="secondary" style="display:none">Open public JSON</button>
      </div>
    </section>

    <!-- 3) Feed -->
    <section class="card">
      <h2>3) Feed (Neueste)</h2>
      <div class="row">
        <button id="btn-feed" class="secondary">Load feed</button>
      </div>
      <ul id="feed" class="list"></ul>
    </section>

    <!-- Log -->
    <section class="card">
      <h2>Log</h2>
      <pre id="log"></pre>
    </section>
  </main>

  <script>
    // Kill any old Service Workers + caches from previous builds
    (async () => {
      try {
        if ('serviceWorker' in navigator) {
          const regs = await navigator.serviceWorker.getRegistrations();
          for (const r of regs) { await r.unregister(); }
        }
        if (window.caches) {
          const keys = await caches.keys();
          for (const k of keys) { await caches.delete(k); }
        }
        // optisch: Flag damit du siehst, dass die neue Datei geladen ist
        document.body.setAttribute('data-appjs', 'v7');
      } catch (e) {}
    })();
  </script>

  <!-- App-Logik -->
  <script src="app.js?v=7"></script>
</body>
</html>   
